import{r as c,X as s,a4 as fe,a2 as P}from"./index-DykNZu5D.js";const ne={SINGLE:"single"},w={EASY:"easy",MEDIUM:"medium",HARD:"hard"},j={SPORT:"sport",SUV:"suv",POLICE:"police"},N=60,b=60,B=60,te=40,u=30,m=30,ye=({gameMode:h,player1Name:S,difficulty:f,vehicleType:p,backToSettings:C})=>{const g=c.useRef(null),I=c.useRef(null),y=c.useRef(null),E=c.useRef(null),T=c.useRef(null);c.useEffect(()=>{const e=new Image;return p===j.SPORT?e.src="/GameHub/racing-car.png":p===j.POLICE?e.src="/GameHub/police-car.png":e.src="/GameHub/suv-car.png",e.onload=()=>{I.current=e},e.onerror=()=>{I.current=null},()=>{I.current=null}},[p]),c.useEffect(()=>{const e=new Image;e.src="/GameHub/car-shield.png",e.onload=()=>{E.current=e},e.onerror=()=>{E.current=null};const t=new Image;return t.src="/GameHub/speed.png",t.onload=()=>{T.current=t},t.onerror=()=>{T.current=null},()=>{E.current=null,T.current=null}},[]),c.useEffect(()=>{const e=["/GameHub/car2.png","/GameHub/car3.png","/GameHub/car4.png","/GameHub/car5.png","/GameHub/car6.png","/GameHub/playerCar.png","/GameHub/playerCar2.png","/GameHub/playerCar3.png","/GameHub/racing-car.png"],t=[];return e.forEach((a,n)=>{const i=new Image;i.src=a,i.onload=()=>{t[n]=i,t.filter(l=>l).length===e.length&&(y.current=t)},i.onerror=()=>{console.warn(`Failed to load obstacle image: ${a}`)}}),()=>{y.current=null}},[]);const[O,$]=c.useState(!1),[G,V]=c.useState(!1),[M,H]=c.useState({player1:0}),[Y,X]=c.useState(null),[L,D]=c.useState(3),[k,U]=c.useState(!1),[_,A]=c.useState(!1),[le,F]=c.useState(null),r=c.useRef({player1:{x:0,y:0,speed:3,lane:1},obstacles:[],powerUps:[],roadSpeed:5,roadY:0,animationFrameId:0,keysPressed:new Set,shield:{player1:!1},speedBoost:{player1:0},lastObstacleTime:0,lastPowerUpTime:0,gameTime:0,difficultySpeed:f===w.EASY?2:f===w.MEDIUM?3:4,isGameOver:!1});c.useEffect(()=>{(()=>{const a=g.current;!a||!a.getContext("2d")||(r.current.player1={x:a.width/2-N/2,y:a.height-b-20,speed:5,lane:1},r.current.obstacles=[],r.current.powerUps=[],r.current.roadY=0,r.current.difficultySpeed=f===w.EASY?2:f===w.MEDIUM?3:4,H({player1:0}),X(null),D(3))})();const t=r.current.animationFrameId;return()=>{cancelAnimationFrame(t)}},[f,h]),c.useEffect(()=>{if(L===null)return;const e=setInterval(()=>{D(t=>t===null?null:t<=1?(clearInterval(e),V(!0),null):t-1)},1e3);return()=>clearInterval(e)},[L]),c.useEffect(()=>{const e=a=>{if(a.code==="Space"){a.preventDefault(),G&&!O&&!k&&A(n=>{const i=!n;return F(i?"space":null),i});return}r.current.keysPressed.add(a.key)},t=a=>{r.current.keysPressed.delete(a.key)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[G,O,k]);const q=c.useRef(M);c.useEffect(()=>{q.current=M},[M]);const W=c.useCallback(()=>{const e=r.current.keysPressed,t=g.current;if(t){if(e.has("ArrowLeft")){const a=u;r.current.player1.x=Math.max(a,r.current.player1.x-r.current.player1.speed)}if(e.has("ArrowRight")){const a=t.width-u-N;r.current.player1.x=Math.min(a,r.current.player1.x+r.current.player1.speed)}}},[]),K=c.useCallback((e,t,a,n)=>{e.fillStyle="#32CD32",e.fillRect(0,0,u,t.height),e.fillRect(t.width-u,0,u,t.height),e.fillStyle="#333",e.fillRect(u,0,t.width-u*2,t.height),e.strokeStyle="#fff",e.lineWidth=2,e.setLineDash([20,20]),r.current.roadY+=r.current.roadSpeed,r.current.roadY>40&&(r.current.roadY=0);for(let i=1;i<a;i++){const l=u+i*n;e.beginPath();let o=-40+r.current.roadY;for(;o<t.height;)e.moveTo(l,o),e.lineTo(l,o+20),o+=40;e.stroke()}e.setLineDash([])},[]),Z=c.useCallback(e=>{const t=I.current;t?e.drawImage(t,r.current.player1.x,r.current.player1.y,N,b):(e.fillStyle="#FF5733",e.fillRect(r.current.player1.x,r.current.player1.y,N,b)),r.current.shield.player1&&(e.strokeStyle="#00FFFF",e.lineWidth=3,e.beginPath(),e.ellipse(r.current.player1.x+N/2,r.current.player1.y+b/2,N*.7,b*.7,0,0,Math.PI*2),e.stroke())},[]),z=c.useCallback(e=>{const t=e.canvas,a=q.current;e.fillStyle="#FFF",e.font="bold 20px Arial",e.textAlign="center",e.fillText(`${S}: ${Math.floor(a.player1)}`,t.width/2,25),e.strokeStyle="#FFD700",e.lineWidth=1,e.strokeText(`${S}: ${Math.floor(a.player1)}`,t.width/2,25)},[S]),J=c.useCallback((e,t)=>{const a=Math.random();let n;if(e===6){const d=1/e;a<d?n=0:a<d*2?n=1:a<d*3?n=2:a<d*4?n=3:a<d*5?n=4:n=5}else if(e===4){const d=1/e;a<d?n=0:a<d*2?n=1:a<d*3?n=2:n=3}else e===3?a<.4?n=0:a<.7?n=1:n=2:n=Math.floor(Math.random()*e);const i=(Math.random()-.5)*16,l=u+n*t+(t-B)/2+i,o=u+n*t+2,R=u+(n+1)*t-B-2,x=Math.max(o,Math.min(R,l)),v=Math.floor(Math.random()*9);r.current.obstacles.push({x,y:-te,lane:n,width:B,height:te,imageIndex:v})},[]),Q=c.useCallback((e,t)=>{const a=e.getContext("2d");if(!a)return;const i=r.current.difficultySpeed+Math.min(5,r.current.gameTime/30);r.current.obstacles=r.current.obstacles.filter(l=>{l.y+=i*Math.max(1,t*60);const o=y.current;return o&&o[l.imageIndex]?a.drawImage(o[l.imageIndex],l.x,l.y,l.width,l.height):(a.fillStyle="#FFA648",a.fillRect(l.x,l.y,l.width,l.height)),l.y<e.height})},[]),ee=c.useCallback((e,t)=>{const a=Math.random();let n;if(e===6){const d=1/e;a<d?n=0:a<d*2?n=1:a<d*3?n=2:a<d*4?n=3:a<d*5?n=4:n=5}else if(e===4){const d=1/e;a<d?n=0:a<d*2?n=1:a<d*3?n=2:n=3}else e===3?a<.4?n=0:a<.7?n=1:n=2:n=Math.floor(Math.random()*e);const i=(Math.random()-.5)*12,l=u+n*t+(t-m)/2+i,o=u+n*t+2,R=u+(n+1)*t-m-2,x=Math.max(o,Math.min(R,l)),v=Math.random()>.5?"speed":"shield";r.current.powerUps.push({x,y:-m,type:v,active:!0})},[]),se=c.useCallback((e,t)=>{const a=e.getContext("2d");if(!a)return;const i=r.current.difficultySpeed+Math.min(5,r.current.gameTime/30);r.current.powerUps=r.current.powerUps.filter(l=>{if(!l.active)return!1;if(l.y+=i*Math.max(1,t*60),l.type==="speed"){const o=T.current;o?a.drawImage(o,l.x,l.y,m,m):(a.fillStyle="#FFFF00",a.beginPath(),a.arc(l.x+m/2,l.y+m/2,m/2,0,Math.PI*2),a.fill())}else{const o=E.current;o?a.drawImage(o,l.x,l.y,m,m):(a.fillStyle="#00FFFF",a.beginPath(),a.arc(l.x+m/2,l.y+m/2,m/2,0,Math.PI*2),a.fill())}return l.y<e.height})},[]),re=c.useCallback(()=>{for(const e of r.current.obstacles)if(!r.current.shield.player1&&r.current.player1.x+8<e.x+e.width-8&&r.current.player1.x+N-8>e.x+8&&r.current.player1.y+8<e.y+e.height-8&&r.current.player1.y+b-8>e.y+8){ie(null);return}for(const e of r.current.powerUps)e.active&&r.current.player1.x<e.x+m&&r.current.player1.x+N>e.x&&r.current.player1.y<e.y+m&&r.current.player1.y+b>e.y&&(e.active=!1,ce(e.type))},[]),ce=e=>{e==="speed"?r.current.speedBoost.player1=5:(r.current.shield.player1=!0,setTimeout(()=>{r.current.shield.player1=!1},5e3))},ie=e=>{$(!0),X(e),r.current.isGameOver=!0,cancelAnimationFrame(r.current.animationFrameId)},oe=()=>{$(!1),V(!1),D(3),H({player1:0}),r.current.isGameOver=!1,r.current.obstacles=[],r.current.powerUps=[],r.current.lastObstacleTime=0,r.current.lastPowerUpTime=0,r.current.gameTime=0,r.current.animationFrameId=0,r.current.shield={player1:!1},r.current.speedBoost={player1:0},r.current.player1&&(r.current.player1.speed=5)},de=()=>{A(!1),U(!1),F(null),r.current.animationFrameId=0},ae=()=>{U(!1),le==="help"&&(A(!1),F(null),r.current.animationFrameId=0)};return c.useEffect(()=>{if(!G||O)return;if(_){cancelAnimationFrame(r.current.animationFrameId);return}const e=g.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const a=6,i=(e.width-u*2)/a;let l=performance.now();const o=x=>{const v=(x-l)/1e3;if(l=x,r.current.gameTime+=v,t.clearRect(0,0,e.width,e.height),K(t,e,a,i),W(),Q(e,v),se(e,v),Z(t),z(t),re(),r.current.isGameOver)return;const d=1500-f.length*200,ue=(Math.random()-.5)*400,me=Math.max(500,d+ue);x-r.current.lastObstacleTime>me&&(J(a,i),r.current.lastObstacleTime=x),x-r.current.lastPowerUpTime>5e3&&Math.random()>.7&&(ee(a,i),r.current.lastPowerUpTime=x),r.current.speedBoost.player1>0&&(r.current.speedBoost.player1-=v),H(pe=>({player1:pe.player1+v*10}));const he=requestAnimationFrame(o);r.current.animationFrameId=he},R=requestAnimationFrame(o);return r.current.animationFrameId=R,()=>{cancelAnimationFrame(R)}},[G,O,_,h,f,K,W,Q,se,Z,z,re,J,ee]),s.jsxs("div",{className:"carracing-game-container",children:[s.jsx("h1",{className:"game-title",children:s.jsx("span",{className:"game-title-main",children:"Car Racing Game"})}),s.jsxs("div",{className:"game-controls",children:[s.jsx("button",{onClick:C,className:"control-btn",children:"Back to Settings"}),s.jsxs("div",{className:"pause-instruction",children:[s.jsx("span",{className:"pause-text",children:"Press"}),s.jsx("span",{className:"pause-key",children:"SPACE"}),s.jsx("span",{className:"pause-text",children:"to Pause"})]}),s.jsx("button",{onClick:()=>{A(!0),F("help"),U(!0)},className:"control-btn help-btn",children:"â“ Help"})]}),L!==null&&s.jsx("div",{className:"countdown-overlay",children:s.jsx("div",{className:"countdown",children:L})}),O&&s.jsx("div",{className:"game-over-overlay",children:s.jsxs("div",{className:"game-over-modal",children:[s.jsx("h2",{children:"Game Over!"}),Y?s.jsxs("p",{children:[Y," wins!"]}):s.jsxs("p",{children:["Final Score: ",Math.floor(M.player1)]}),s.jsx("div",{className:"game-over-actions",children:s.jsx("button",{onClick:oe,className:"control-btn restart-btn",children:"ðŸ”„ Play Again"})}),s.jsx("div",{className:"game-over-actions",children:s.jsx("button",{onClick:C,className:"control-btn restart-btn",children:"Back to Settings"})})]})}),s.jsxs("div",{className:"game-area",children:[s.jsx("canvas",{ref:g,width:600,height:500,className:"racing-canvas"}),_&&!O&&s.jsx("div",{className:"pause-overlay",children:s.jsx("div",{className:"pause-message",children:k?"â¸ï¸ GAME PAUSED":"â¸ï¸ PAUSED - Press SPACE to Resume"})})]}),s.jsx("div",{className:"game-info",children:s.jsxs("div",{className:"player-info",children:[s.jsxs("div",{className:"player-name-container",children:[s.jsx("span",{className:"player-label",children:"Player:"}),s.jsx("span",{className:"player-name",children:S})]}),s.jsxs("div",{className:"power-ups",children:[s.jsxs("div",{className:`power-up-item ${r.current.shield.player1?"active":"inactive"}`,children:[s.jsx("span",{className:"power-up-indicator shield",children:"ðŸ›¡ï¸"}),s.jsx("span",{className:"power-up-label",children:"Shield"}),s.jsx("span",{className:"power-up-timer power-up-timer--placeholder"})]}),s.jsxs("div",{className:`power-up-item ${r.current.speedBoost.player1>0?"active":"inactive"}`,children:[s.jsx("span",{className:"power-up-indicator speed",children:"âš¡"}),s.jsx("span",{className:"power-up-label",children:"Speed"}),s.jsx("span",{className:"power-up-timer",children:r.current.speedBoost.player1>0?`${Math.ceil(r.current.speedBoost.player1)}s`:""})]})]})]})}),k&&s.jsx("div",{className:"help-modal-overlay",onClick:ae,children:s.jsxs("div",{className:"help-modal",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"help-modal-header",children:[s.jsx("h3",{children:"ðŸŽ® Game Instructions"}),s.jsx("button",{className:"close-btn",onClick:ae,children:"âœ•"})]}),s.jsxs("div",{className:"help-modal-content",children:[s.jsxs("div",{className:"help-section",children:[s.jsx("h4",{children:"Controls"}),s.jsx("div",{className:"controls-list",children:s.jsxs("div",{className:"control-item",children:[s.jsx("span",{className:"control-key",children:"â† â†’"}),s.jsx("span",{className:"control-description",children:"Use arrow keys to move your car left and right"})]})})]}),s.jsxs("div",{className:"help-section",children:[s.jsx("h4",{children:"Objective"}),s.jsx("p",{children:"Avoid hitting other cars and obstacles on the road. The longer you survive, the higher your score!"})]}),s.jsxs("div",{className:"help-section",children:[s.jsx("h4",{children:"Power-ups"}),s.jsxs("div",{className:"power-ups-list",children:[s.jsxs("div",{className:"power-up-item",children:[s.jsx("span",{className:"power-up-icon",children:"ðŸ›¡ï¸"}),s.jsxs("div",{children:[s.jsx("strong",{children:"Shield"}),s.jsx("p",{children:"Makes you invincible for 5 seconds"})]})]}),s.jsxs("div",{className:"power-up-item",children:[s.jsx("span",{className:"power-up-icon",children:"âš¡"}),s.jsxs("div",{children:[s.jsx("strong",{children:"Speed Boost"}),s.jsx("p",{children:"Increases your movement speed for 5 seconds"})]})]})]})]}),s.jsxs("div",{className:"help-section",children:[s.jsx("h4",{children:"Tips"}),s.jsxs("ul",{children:[s.jsx("li",{children:"Stay in your lane and watch for incoming traffic"}),s.jsx("li",{children:"Collect power-ups to gain advantages"}),s.jsx("li",{children:"The game gets faster as you progress"}),s.jsx("li",{children:"Use the shield strategically when obstacles are close"})]})]}),s.jsx("div",{className:"help-modal-actions",children:s.jsx("button",{onClick:de,className:"control-btn resume-btn",children:"â–¶ï¸ Resume Game"})})]})]})})]})},xe=()=>{const[h,S]=c.useState({gameMode:ne.SINGLE,player1Name:"",player2Name:"Player 2",difficulty:w.MEDIUM,vehicleType:j.SPORT}),[f,p]=c.useState(!1),[C,g]=c.useState(!1);return{settings:h,gameStarted:f,redirectToGame:C,updateSettings:E=>{S(T=>({...T,...E}))},startGame:()=>{p(!0),setTimeout(()=>{p(!1),g(!0)},1500)},setRedirectToGame:g}},ve=()=>{const{settings:h,gameStarted:S,redirectToGame:f,updateSettings:p,startGame:C,setRedirectToGame:g}=xe();if(S)return s.jsx(fe,{});if(f)return s.jsx(ye,{...h,backToSettings:()=>g(!1)});const I=y=>{y.preventDefault(),C()};return s.jsxs(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"carracing-initial-container",children:[s.jsx("h2",{children:"Car Racing Settings"}),s.jsxs("form",{onSubmit:I,className:"carracing-settings-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"player1",children:"Player 1 Name:"}),s.jsx("input",{type:"text",id:"player1",value:h.player1Name,onChange:y=>p({player1Name:y.target.value}),required:!0,placeholder:"Enter Player 1 name"})]}),h.gameMode===ne.SINGLE&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Difficulty Level:"}),s.jsxs("select",{value:h.difficulty,onChange:y=>p({difficulty:y.target.value}),children:[s.jsx("option",{value:w.EASY,children:"Easy"}),s.jsx("option",{value:w.MEDIUM,children:"Medium"}),s.jsx("option",{value:w.HARD,children:"Hard"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Vehicle Type:"}),s.jsxs("div",{className:"vehicle-options",children:[s.jsxs(P.div,{className:`vehicle-option ${h.vehicleType===j.SPORT?"selected":""}`,onClick:()=>p({vehicleType:j.SPORT}),whileHover:{scale:1.03},whileTap:{scale:.98},children:[s.jsx("div",{className:"vehicle-icon",children:"ðŸŽï¸"}),s.jsx("p",{children:"Sport Car"}),s.jsx("small",{children:"Fast & Agile"})]}),s.jsxs(P.div,{className:`vehicle-option ${h.vehicleType===j.SUV?"selected":""}`,onClick:()=>p({vehicleType:j.SUV}),whileHover:{scale:1.03},whileTap:{scale:.98},children:[s.jsx("div",{className:"vehicle-icon",children:"ðŸš—"}),s.jsx("p",{children:"Private Car"}),s.jsx("small",{children:"Comfort & Style"})]}),s.jsxs(P.div,{className:`vehicle-option ${h.vehicleType===j.POLICE?"selected":""}`,onClick:()=>p({vehicleType:j.POLICE}),whileHover:{scale:1.03},whileTap:{scale:.98},children:[s.jsx("div",{className:"vehicle-icon",children:"ðŸš“"}),s.jsx("p",{children:"Police Car"}),s.jsx("small",{children:"High Speed Chase"})]})]})]}),s.jsx(P.button,{type:"submit",whileHover:{scale:1.05},whileTap:{scale:.95},className:"start-game-btn",children:"Start Game"})]})]})};export{ve as default};
